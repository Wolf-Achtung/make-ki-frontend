<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Zahlung & Freischaltung</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f4; padding: 2em; }
    .container { background: #fff; padding: 2em; border-radius: 8px; max-width: 600px; margin: auto; }
    h1 { color: #002649; }
    .info { margin-bottom: 2em; }
    .button-container { text-align: center; margin-top: 2em; }
    .button {
      background: #002649;
      color: white;
      padding: 1em 2em;
      text-decoration: none;
      border-radius: 5px;
      font-size: 1.1em;
      cursor: pointer;
      display: inline-block;
    }
    .button:hover { background: #004080; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Freischaltung der Vollauswertung</h1>
    <div class="info">
      <p>Ihre individuelle Auswertung ist fast fertig! F√ºr den Zugang zur Vollversion inkl. PDF-Download und Empfehlungen bitten wir um eine einmalige Freischaltungspauschale.</p>
      <p><strong>Preis:</strong> 29,00‚ÄØ‚Ç¨ (inkl. MwSt)</p>
      <p>Nach der Zahlung erhalten Sie die Auswertung sofort per E-Mail und k√∂nnen sie auch direkt herunterladen.</p>
    </div>

    <div class="button-container">
      <span class="button" onclick="generatePDF()">Zahlung abgeschlossen ‚Äì weiter zur Auswertung</span>
    </div>
  </div>

  <script>
    async function generatePDF() {
      const fullData = JSON.parse(sessionStorage.getItem("gpt_result"));
      if (!fullData) {
        alert("Keine gespeicherten Daten gefunden.");
        return;
      }

      const response = await fetch("https://make-ki-backend-production.up.railway.app/generate-pdf", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          ...fullData,
          template_variant: "full"
        })
      });

      const result = await response.json();
      if (result.pdf_url) {
        window.location.href = `danke.html?pdf=${encodeURIComponent(result.pdf_url)}`;
      } else {
        alert("PDF konnte nicht erstellt werden.");
      }
    }
  </script>
</body>
</html>
