<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>KI-Readiness & F√∂rderung</title>
    <style>
        body { font-family: sans-serif; max-width: 700px; margin: 2rem auto; color: #003366; }
        h1, h2, h3 { color: #003366; }
        select, input { width: 100%; padding: 0.5rem; margin-bottom: 1rem; }
        button { padding: 0.5rem 1rem; background: #003366; color: white; border: none; cursor: pointer; }
        button:hover { background: #0055aa; }
        pre { background: #f0f0f0; padding: 1rem; border-radius: 5px; overflow-x:auto; }
        #devPanel { background: #f9f9f9; border: 1px solid #ccc; padding: 1rem; margin-top: 1rem; display: none; }
    </style>
</head>
<body>
    <h1>F√∂rderf√§higkeit & KI-Readiness pr√ºfen</h1>
    <form id="briefingForm">
        <input type="text" name="unternehmen" placeholder="Unternehmen" required>
        <input type="text" name="name" placeholder="Ihr Name" required>
        <input type="email" name="email" placeholder="E-Mail" required>
        <input type="text" name="plz" placeholder="Postleitzahl Ihres Unternehmens" required>

        <select name="branche" required>
            <option value="">Bitte Branche ausw√§hlen</option>
            <option>Finanzen & Steuern</option>
            <option>Medien & Marketing</option>
            <option>Kommunikation & PR</option>
            <option>Bildung & Coaching</option>
            <option>Verwaltung & √ñffentliche Hand</option>
            <option>Handel & E-Commerce</option>
            <option>IT & Software</option>
            <option>Sonstige</option>
        </select>

        <select name="massnahme" required>
            <option value="">Geplante Ma√ünahme w√§hlen</option>
            <option>Beratung / Strategie</option>
            <option>Risikoanalyse</option>
            <option>Datenschutz / Compliance</option>
            <option>KI-Tool-Integration, z.B. KI-Agents</option>
            <option>Mitarbeiterschulung / Change Management</option>
            <option>noch unklar</option>
        </select>

        <select name="bereich" required>
            <option value="">Bereich ausw√§hlen</option>
            <option>Marketing</option>
            <option>Vertrieb</option>
            <option>Gesch√§ftsf√ºhrung</option>
            <option>Personal</option>
            <option>Produktion</option>
            <option>Sonstige</option>
        </select>

        <h2>Datenschutz & KI-Management</h2>
        <label>Haben Sie technische Ma√ünahmen getroffen (Firewall, Verschl√ºsselung etc.)?</label>
        <select name="frage1"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Gibt es Schulungen oder Infos f√ºr Mitarbeiter zu Datenschutz, KI oder rechtlichen Anforderungen?</label>
        <select name="frage2"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Haben Sie einen Datenschutzbeauftragten oder Verantwortlichen benannt?</label>
        <select name="frage3"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>F√ºhren Sie Risikoanalysen oder Datenschutz-Folgenabsch√§tzungen durch?</label>
        <select name="frage4"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Gibt es Prozesse zur Datenl√∂schung oder Anonymisierung?</label>
        <select name="frage5"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Wissen Mitarbeiter, wie bei Datenschutzverletzungen zu handeln ist?</label>
        <select name="frage6"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Werden Betroffenenrechte (Auskunft, L√∂schung) aktiv umgesetzt?</label>
        <select name="frage7"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Gibt es eine Dokumentation der Datenverarbeitungsprozesse?</label>
        <select name="frage8"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>Existieren Meldepflichten & Abl√§ufe bei Datenschutzvorf√§llen?</label>
        <select name="frage9"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <label>F√ºhren Sie regelm√§√üige interne Audits zu Datenschutz und KI durch?</label>
        <select name="frage10"><option>nein</option><option>ja</option><option>noch unklar</option></select>

        <button type="submit">Briefing erstellen</button>
    </form>

    <div id="result" style="margin-top:2rem;"></div>

    <div style="margin-top:2rem;">
        <button onclick="toggleDevPanel()" style="background:#666;color:white;padding:5px 10px;border:none;border-radius:4px;cursor:pointer;">
            üîç Developer-Panel anzeigen
        </button>
    </div>
    <div id="devPanel">
        <h3>Developer Debug Panel</h3>
        <strong>Gesendetes JSON:</strong>
        <pre id="devFormData"></pre>
        <strong>Roh-Response vom Server:</strong>
        <pre id="devRawResponse"></pre>
    </div>

    <script>
        let devPanelVisible = false;
        function toggleDevPanel() {
            devPanelVisible = !devPanelVisible;
            document.getElementById('devPanel').style.display = devPanelVisible ? 'block' : 'none';
        }

        document.getElementById('briefingForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const data = Object.fromEntries(new FormData(e.target));
            document.getElementById('devFormData').innerText = JSON.stringify(data, null, 2);

            const res = await fetch("https://make-ki-backend-neu-production.up.railway.app/briefing", {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const json = await res.json();
            document.getElementById('devRawResponse').innerText = JSON.stringify(json, null, 2);

            let fragenAuditHTML = '';
            if (json.frage_audit) {
                fragenAuditHTML = '<h3>Frage-f√ºr-Frage-Audit</h3><ul>' +
                  Object.entries(json.frage_audit).map(([k,v]) => `<li><strong>${k}:</strong> ${v}</li>`).join('') +
                  '</ul>';
            }

            document.getElementById('result').innerHTML = `
                <h2>Ihr pers√∂nliches KI-Briefing</h2>
                <strong>Score:</strong> ${json.compliance_score ?? 0}/10<br>
                <strong>Badge:</strong> ${json.badge_level ?? 'Bronze'}<br><br>
                <strong>Readiness:</strong> ${json.readiness_analysis || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Compliance:</strong> ${json.compliance_analysis || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Use Case:</strong> ${json.use_case_analysis || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Branche Trend:</strong> ${json.branche_trend || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Vision:</strong> ${json.vision || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Quick Wins:</strong> ${json.quick_wins?.join(", ") || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Toolstipps:</strong> ${json.toolstipps?.join(", ") || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>F√∂rdertipps:</strong> ${json.foerdertipps?.join(", ") || 'Keine Daten verf√ºgbar'}<br><br>
                <strong>Executive Summary:</strong> ${json.executive_summary || 'Keine Daten verf√ºgbar'}
                ${fragenAuditHTML}
            `;
        });
    </script>
</body>
</html>
