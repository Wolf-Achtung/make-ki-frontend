<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KI-Readiness & Datenschutz-Check</title>
  <style>
    body { font-family: monospace; padding: 20px; }
    label { display: block; margin: 10px 0 5px; }
    input, select, textarea { width: 100%; padding: 8px; margin-bottom: 10px; }
    button { background: #003b5a; color: white; padding: 10px 20px; border: none; cursor: pointer; }
    #debugOutput { background: #eee; padding: 10px; white-space: pre-wrap; margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Vollst√§ndiger KI-Readiness-Check</h1>
  <form id="mainForm">
    <label>Email</label><input name="email" type="email" required>
    <label>Name</label><input name="name" required>
    <label>Unternehmen</label><input name="unternehmen" required>
    <label>PLZ</label><input name="plz">
    <label>Branche</label><input name="branche">

    <label>Geplanter Einsatzbereich</label><input name="bereich">
    <label>Produkte / Dienstleistungen</label><input name="produkt_dienstleistung">
    <label>Geplante Ma√ünahme</label><input name="massnahme">

    <label>Mitarbeiterzahl</label><input name="mitarbeiterzahl" type="number">
    <label>Selbstst√§ndig / freiberuflich?</label><select name="selbststaendig">
      <option value="">Bitte w√§hlen</option>
      <option>Ja</option><option>Nein</option>
    </select>

    <label>Zielgruppen</label><input name="zielgruppen">
    <label>IT-Systeme</label><input name="it_systeme">
    <label>KI-Tools im Einsatz</label><input name="ki_tools">

    <label>Herausforderungen</label><textarea name="herausforderungen"></textarea>
    <label>Innovation Potentiale</label><textarea name="innovation_potentiale"></textarea>
    <label>Ziele in 3 Jahren</label><textarea name="ziele_3jahre"></textarea>
    <label>Moonshot (gro√ües Ziel)</label><textarea name="moonshot"></textarea>

    <label>Vorfaelle (Sicherheitsvorf√§lle?)</label><textarea name="vorfaelle"></textarea>

    <!-- Die "frage1" bis "frage10" sind exemplarisch als Ja/Nein -->
    <label>Frage 1</label><select name="frage1"><option>Ja</option><option>Nein</option></select>
    <label>Frage 2</label><select name="frage2"><option>Ja</option><option>Nein</option></select>
    <label>Frage 3</label><select name="frage3"><option>Ja</option><option>Nein</option></select>
    <label>Frage 4</label><select name="frage4"><option>Ja</option><option>Nein</option></select>
    <label>Frage 5</label><select name="frage5"><option>Ja</option><option>Nein</option></select>
    <label>Frage 6</label><select name="frage6"><option>Ja</option><option>Nein</option></select>
    <label>Frage 7</label><select name="frage7"><option>Ja</option><option>Nein</option></select>
    <label>Frage 8</label><select name="frage8"><option>Ja</option><option>Nein</option></select>
    <label>Frage 9</label><select name="frage9"><option>Ja</option><option>Nein</option></select>
    <label>Frage 10</label><select name="frage10"><option>Ja</option><option>Nein</option></select>

    <label><input type="checkbox" name="privacy" required> Ich akzeptiere die Datenschutzerkl√§rung</label>
    <label><input type="checkbox" name="gpt_consent" required> Ich willige ein, dass meine Daten durch GPT verarbeitet werden.</label>

    <button type="submit">Analyse starten</button>
  </form>

  <pre id="debugOutput">Debug-Ausgabe...</pre>

  <script>
    document.getElementById("mainForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const debug = document.getElementById("debugOutput");
      const data = Object.fromEntries(new FormData(e.target));
      debug.textContent = "‚è≥ Sende Daten an Server...\n" + JSON.stringify(data, null, 2);

      try {
        const res = await fetch("https://make-ki-backend-neu-production.up.railway.app/briefing", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(data)
        });
        debug.textContent += "\n\n‚úÖ Server Status: " + res.status;

        const json = await res.json();
        debug.textContent += "\n\nüì¶ Antwort: " + JSON.stringify(json, null, 2);

        if (json.pdf_url) {
          const filename = json.pdf_url.split("/").pop();
          window.location.href = "/formular/thankyou.html?file=" + encodeURIComponent(filename);
        }
      } catch (err) {
        debug.textContent += "\n‚ùå Fehler: " + err;
      }
    });
  </script>
</body>
</html>
