<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>KI-Readiness & Förderung</title>
    <style>
        body { font-family: sans-serif; max-width: 900px; margin: 2rem auto; color: #003366; }
        h1, h2 { color: #003366; }
        .badge { margin: 1rem 0; padding: 1rem; background: #f0f0f0; border-left: 5px solid #003366; }
        .section { margin-top: 2rem; }
        ul { line-height: 1.6; }
        .debug { margin-top: 2rem; background: #eee; padding: 1rem; font-family: monospace; }
        .hidden { display: none; }
    </style>
</head>
<body>

<h1>Ihr persönliches KI-Briefing</h1>

<form id="briefingForm">
    <input type="text" placeholder="Unternehmen" name="unternehmen" required><br>
    <input type="text" placeholder="Name" name="name" required><br>
    <input type="email" placeholder="E-Mail" name="email" required><br>
    <select name="branche" required>
        <option value="">Branche wählen</option>
        <option>Finanzen & Steuern</option>
        <option>Medien & Marketing</option>
        <option>Kommunikation & PR</option>
        <option>Bildung & Coaching</option>
        <option>Verwaltung & Öffentliche Hand</option>
        <option>Handel & E-Commerce</option>
        <option>IT & Software</option>
        <option>Sonstige</option>
    </select><br>
    <select name="massnahme" required>
        <option value="">Geplante Maßnahme wählen</option>
        <option>Beratung / Strategie</option>
        <option>Risikoanalyse</option>
        <option>Datenschutz / Compliance</option>
        <option>KI-Tool-Integration, z.B. KI-Agents</option>
        <option>Mitarbeiterschulung / Change Management</option>
        <option>noch unklar</option>
    </select><br>
    <select name="bereich" required>
        <option value="">Bereich wählen</option>
        <option>Marketing</option>
        <option>Vertrieb</option>
        <option>Geschäftsführung</option>
        <option>Produktion</option>
        <option>IT & Sicherheit</option>
        <option>HR</option>
        <option>Sonstige</option>
    </select><br>
    <button type="submit">Briefing erstellen</button>
</form>

<div class="section" id="resultSection" style="display:none;">
    <div id="score"></div>
    <div id="badge"></div>
    <div id="badgeNote" style="font-size:0.9em; color:#555;"></div>

    <div class="section"><h2>Readiness</h2><div id="readiness"></div></div>
    <div class="section"><h2>Compliance</h2><div id="compliance"></div></div>
    <div class="section"><h2>Use Cases</h2><div id="useCases"></div></div>
    <div class="section"><h2>Fördertipps</h2><div id="foerdertipps"></div></div>
    <div class="section"><h2>Toolkompass</h2><div id="toolkompass"></div></div>
    <div class="section"><h2>Vision</h2><div id="vision"></div></div>
    <details class="debug">
        <summary>Rohdaten (Debug)</summary>
        <pre id="raw"></pre>
    </details>
</div>

<script>
document.getElementById("briefingForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target);
    const data = Object.fromEntries(formData.entries());
    const res = await fetch("https://make-ki-backend-neu-production.up.railway.app/briefing", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
    });
    const json = await res.json();
    document.getElementById("resultSection").style.display = "block";

    document.getElementById("score").innerHTML = `<strong>Score:</strong> ${json.compliance_score ?? "?"}/10`;
    document.getElementById("badge").innerHTML = json.badge_code ?? `<div class="badge">Kein Badge generiert</div>`;
    document.getElementById("badgeNote").innerText = "Dieses Siegel zeigt, dass dieses Unternehmen einen KI-Readiness & Compliance Check durchlaufen hat und seine Chancen und Baustellen kennt.";

    document.getElementById("readiness").innerText = json.readiness_analysis ?? "-";
    document.getElementById("compliance").innerText = json.compliance_analysis ?? "-";
    document.getElementById("useCases").innerText = json.use_case_analysis ?? "-";
    document.getElementById("vision").innerText = json.vision ?? "-";

    // Fördertipps
    if (json.foerdertipps && json.foerdertipps.length) {
        let html = "<ul>";
        json.foerdertipps.forEach(f => html += `<li><a href="${f.link}" target="_blank">${f.programm}</a>: ${f.kurzbeschreibung}</li>`);
        html += "</ul>";
        document.getElementById("foerdertipps").innerHTML = html;
    } else {
        document.getElementById("foerdertipps").innerText = "-";
    }

    // Tools
    if (json.toolkompass && json.toolkompass.length) {
        let html = "<ul>";
        json.toolkompass.forEach(t => html += `<li><strong>${t.name}</strong> (${t.hersteller}): ${t.einsatz}</li>`);
        html += "</ul>";
        document.getElementById("tools").innerHTML = html;
    } else {
        document.getElementById("tools").innerText = "-";
    }

    document.getElementById("raw").innerText = JSON.stringify(json, null, 2);
});
</script>

</body>
</html>
